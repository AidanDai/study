{"diagram":{"image":{"height":200,"pngdata":"iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsUlEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8GXHmAAFMgHIEAAAAAElFTkSuQmCC","width":200,"y":0,"x":0},"elements":{"id":"root","title":"Ajax","structure":"mind_right","root":true,"theme":"theme3","children":[{"id":"156cc47a48b25714","title":"XMLHttpRequest Level 1","parent":"root","children":[{"id":"156cc5c18d40f25","title":"1、创建 xhr 对象","parent":"156cc47a48b25714","children":[],"note":"```javascript\nfunction createXhr(){\n        var xhr;\n        if (window.XMLHttpRequest){//  IE7+, Firefox, Chrome, Opera, Safari\n              xhr = new XMLHttpRequest();\n         }else{ // IE6, IE5\n               xhr = new ActiveXObject(\"Microsoft.XMLHTTP\");\n         }\n          return xhr;\n } \nvar xhr = createXhr();\n```"},{"id":"156cc5fa13ffc798","title":"2、建立 Http 请求","parent":"156cc47a48b25714","children":[],"note":"```JavaScript\nxhr.open('get','http://127.0.0.1/ajax/ajax.php');\n```"},{"id":"156cc60e4c6a5164","title":"3、监听异步请求","children":[],"parent":"156cc47a48b25714","note":"```javascript\nxhr.onreadystatechange = function(){\n    if(xhr.readyState ==  4) {\n        if((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n            console.log(xhr.responseText);\n        }else {\n            console.log(xhr.status);\n        }\n    }\n}\n```"},{"id":"156cc620068b3570","title":"4、发送数据","parent":"156cc47a48b25714","children":[],"note":"```JavaScript\nxhr.send(data);\n```"},{"id":"156cc62cd22c0475","title":"6、处理服务器响应结果","children":[],"parent":"156cc47a48b25714"}],"note":"```javascript\nfunction createXhr(){\n        var xhr;\n        if (window.XMLHttpRequest){//  IE7+, Firefox, Chrome, Opera, Safari\n              xhr = new XMLHttpRequest();\n         }else{ // IE6, IE5\n               xhr = new ActiveXObject(\"Microsoft.XMLHTTP\");\n         }\n          return xhr;\n } \nvar xhr = createXhr();\n\nxhr.onreadystatechange = function(){\n    if(xhr.readyState ==  4) {\n        if((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n            console.log(xhr.responseText);\n        }else {\n            console.log(xhr.status);\n        }\n    }\n}\nxhr.open('get','http://127.0.0.1/ajax/ajax.php');\nxhr.send(null);\n```"},{"id":"156cc46a6f6f8d97","title":"XMLHttpRequest Level 2","children":[{"id":"156cc480ee46338","title":"Http 请求时限","parent":"156cc46a6f6f8d97","children":[],"note":"```JavaSCript\nxhr.timeout = 3000;\nxhr.ontimeout = function(event){\n    console.log('请求超时！');\n}\n```\n\n注：兼容性问题"},{"id":"156cc49ba2d7ba48","title":"<span style=\"color: rgb(17, 17, 17); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; font-size: 16px; letter-spacing: -0.12px; line-height: 28.8px; word-spacing: 2.4px; background-color: rgb(245, 242, 240);\">FormData</span>","children":[],"parent":"156cc46a6f6f8d97"},{"id":"156cc4c7c7110b6","title":"上传文件","parent":"156cc46a6f6f8d97","children":[],"note":"假定files是一个\"选择文件\"的表单元素（input[type=\"file\"]），我们将它装入FormData对象。\n\n```JavaScript\nvar formData = new FormData();\nfor (var i = 0; i < files.length;i++) {\n　formData.append('files[]', files[i]);\n}\nxhr.send(formData);\n```"},{"id":"156cc522de5d0a81","title":"跨域资源共享（CORS）","children":[],"parent":"156cc46a6f6f8d97","note":"新版本的XMLHttpRequest对象，可以向不同域名的服务器发出HTTP请求。这叫做\"跨域资源共享\"（Cross-origin resource sharing，简称CORS）。\n\n使用\"跨域资源共享\"的前提，是浏览器必须支持这个功能，而且服务器端必须同意这种\"跨域\"。\n\n注：兼容性问题"},{"id":"156cc54351f38c22","title":"接收二进制数据","children":[{"id":"156cc54fc0d1b110","title":"MIMEType","parent":"156cc54351f38c22","children":[],"note":"```JavaScript\nxhr.overrideMimeType(\"text/plain; charset=utf-8\");\n```"},{"id":"156cc54ff957e649","title":"responseType","children":[],"parent":"156cc54351f38c22","note":"```JavaScript\nxhr.responseType = 'blob';\n\nxhr.responseType = \"arraybuffer\";\n```"}],"parent":"156cc46a6f6f8d97"},{"id":"156cc59adc886f52","title":"进度信息","children":[],"parent":"156cc46a6f6f8d97","note":"它分成上传和下载两种情况。下载的progress事件属于XMLHttpRequest对象，上传的progress事件属于XMLHttpRequest.upload对象。"}],"parent":"root"},{"id":"156cc65414a6c542","title":"Http Header","children":[{"id":"156cc656f7cd0681","title":"xhr.setRequestHeader()","children":[],"parent":"156cc65414a6c542"},{"id":"156cc6612aeec992","title":"xhr.getAllRequestHeaders()","children":[],"parent":"156cc65414a6c542"}],"parent":"root"}]}},"meta":{"id":"57c194b0e4b00cf0233508c3","member":"webAidan","exportTime":"2017-06-05 12:33:58","diagramInfo":{"category":"mind_right","title":"Ajax","created":"2016-08-27 21:25:04","creator":"webAidan","modified":"2016-08-27 22:28:14"},"type":"ProcessOn Schema File","version":"1.0"}}